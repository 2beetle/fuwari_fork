[根目录](../../CLAUDE.md) > [src](../) > **i18n**

# i18n 模块文档

## 变更记录 (Changelog)

### 2025-11-26
- 初始化国际化模块文档
- 分析多语言支持结构

## 模块职责

`src/i18n` 目录负责项目的国际化（i18n）功能，提供多语言支持、文本翻译、语言切换等功能。该模块使网站能够支持中文、英文、日文、西班牙文等多种语言，为不同地区的用户提供本地化的内容体验。

## 入口与启动

### 国际化目录结构
```
src/i18n/
├── i18nKey.ts          # 国际化键值定义
├── translation.ts      # 翻译功能实现
└── languages/          # 语言文件目录
    ├── en.ts           # 英文翻译
    ├── es.ts           # 西班牙文翻译
    ├── ja.ts           # 日文翻译
    └── zh_CN.ts        # 中文翻译
```

### 使用方式
```typescript
import { i18n } from '@i18n/translation'
import I18nKey from '@i18n/i18nKey'

// 使用翻译功能
const text = i18n(I18nKey.about)
```

## 国际化架构

### i18nKey.ts - 键值定义

**功能**: 定义所有需要翻译的文本键值

**键值分类**:
- 页面标题和导航
- 用户界面文本
- 表单标签和按钮
- 错误和提示信息
- 日期和时间格式
- 内容分类标签

### translation.ts - 翻译实现

**功能**: 提供翻译函数和语言管理

**核心功能**:
- 获取当前语言设置
- 查找对应的翻译文本
- 支持嵌套键值访问
- 提供默认文本处理

### 语言文件结构
每个语言文件导出一个对象，包含所有翻译文本：
```typescript
export default {
  // 页面相关
  about: "About",
  archive: "Archive",
  home: "Home",

  // 用户界面
  search: "Search",
  tags: "Tags",
  categories: "Categories",

  // 时间相关
  uncategorized: "Uncategorized",
  // ...
}
```

## 支持的语言

### 当前支持语言
- **中文 (zh_CN)**: 简体中文，默认语言
- **英文 (en)**: 英语
- **日文 (ja)**: 日本语
- **西班牙文 (es)**: 西班牙语

### 语言配置
- 语言代码遵循ISO 639-1标准
- 支持地区变体（如zh_CN）
- 在 `src/config.ts` 中配置默认语言

## 文本翻译

### 翻译流程
1. 定义翻译键值 (`i18nKey.ts`)
2. 为每种语言提供翻译文本
3. 在组件中使用翻译函数
4. 根据用户设置切换语言

### 翻译原则
- 保持简洁明了的文本
- 考虑不同语言的文本长度差异
- 使用一致的术语和风格
- 注意文化差异和习惯

## 组件集成

### 在Astro组件中使用
```astro
---
import { i18n } from '@i18n/translation'
import I18nKey from '@i18n/i18nKey'
---

<h1>{i18n(I18nKey.about)}</h1>
```

### 在Svelte组件中使用
```svelte
<script>
  import { i18n } from '@i18n/translation'
  import I18nKey from '@i18n/i18nKey'
</script>

<button>{i18n(I18nKey.search)}</button>
```

### 在Markdown内容中使用
通过组件模板传递翻译文本，或使用自定义插件。

## 语言切换

### 语言检测
- 从浏览器设置检测语言
- 支持用户手动选择
- 记住用户的语言偏好

### 语言存储
- 使用localStorage存储语言设置
- 页面刷新后保持语言选择
- 提供语言切换界面

## 扩展指南

### 添加新语言
1. 在 `languages/` 目录创建新的语言文件
2. 添加所有必要的翻译文本
3. 更新语言配置和检测逻辑
4. 测试新语言的显示效果

### 添加新的翻译键值
1. 在 `i18nKey.ts` 中定义新键值
2. 为每种语言添加对应的翻译
3. 在组件中使用新的翻译键值

### 高级功能
1. 支持复数形式和性别变化
2. 实现RTL（从右到左）语言支持
3. 添加日期和数字的本地化格式
4. 集成专业翻译服务

## 测试与质量

### 翻译质量检查
- 确保所有键值都有对应的翻译
- 检查翻译文本的准确性和自然度
- 验证不同语言的显示效果
- 测试语言切换功能

### 用户体验测试
- 测试语言切换的流畅性
- 验证所有界面文本的翻译
- 检查文本长度的适配性
- 确保语言偏好正确保存

## 常见问题 (FAQ)

### Q: 如何添加新的翻译文本？
A: 在 `i18nKey.ts` 中定义键值，然后在各语言文件中添加翻译。

### Q: 如何处理文本长度差异？
A: 使用响应式设计和弹性布局，确保界面适应不同长度的文本。

### Q: 如何支持动态语言切换？
A: 修改翻译函数以接受语言参数，或实现全局语言状态管理。

### Q: 如何确保翻译的一致性？
A: 建立术语表，使用一致的翻译原则，定期审核翻译质量。

## 相关文件清单

### 核心文件
- `i18nKey.ts` - 翻译键值定义
- `translation.ts` - 翻译功能实现

### 语言文件
- `languages/en.ts` - 英文翻译
- `languages/es.ts` - 西班牙文翻译
- `languages/ja.ts` - 日文翻译
- `languages/zh_CN.ts` - 中文翻译

### 配置文件
- `../config.ts` - 默认语言配置
- `../../astro.config.mjs` - Astro配置

### 使用示例
- `../layouts/Layout.astro` - 页面语言设置
- `../components/*` - 组件中的翻译使用
- `../pages/*` - 页面中的国际化文本